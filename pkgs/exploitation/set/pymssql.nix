# from https://github.com/NixOS/nixpkgs/pull/86876/files
{ lib, buildPythonPackage, fetchPypi, freetds, cython, openssl, setuptools-git, setuptools-scm }:

buildPythonPackage rec {
  pname = "pymssql";
  version = "2.2.1";

  src = fetchPypi {
    inherit pname version;
    sha256 = "cjhTC0WVX3k9I1ZkzG8QTYuPvN62+jlN0i2P5DdIurA=";
  };

  buildInputs = [cython openssl setuptools-git setuptools-scm];
  propagatedBuildInputs = [freetds];

  # The tests require a running instance of SQLServer, so we skip them
  doCheck = false;

  meta = with lib; {
    homepage = "http://pymssql.org/en/stable/";
    description = "A simple database interface for Python that builds on top
      of FreeTDS to provide a Python DB-API (PEP-249) interface to Microsoft
      SQL Server";
    license = licenses.lgpl21;
    maintainers = with maintainers; [ mredaelli ];
  };
}
